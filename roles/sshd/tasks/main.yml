---

# - name: Ensure SSHD server is installed
#   ansible.builtin.package:
#     name: openssh-server
#     state: present

# - name: Ensure SSHD server service is running
#   ansible.builtin.systemd:
#     daemon_reload: true
#     enabled: true
#     name: sshd.service
#     state: started

# - name: Ensure /etc/ssh/sshd_config.d exists
#   ansible.builtin.file:
#     path: /etc/ssh/sshd_config.d
#     state: directory
#     owner: root
#     group: root
#     mode: '0700'

- name: List files in drop-in folder
  ansible.builtin.find:
    paths: /etc/ssh/sshd_config.d
    patterns: "*.config"
    file_type: file
  register: sshd_config_dropin_files
  when: sshd_exclusive_config | bool

- debug:
    var: sshd_config_dropin_files

# - name: Write the sshd_config drop-in file
#   ansible.builtin.copy:
#     content: "{{ item.config }}"
#     dest: /etc/ssh/sshd_config.d/{{ item.dest }}
#     owner: root
#     group: root
#     mode: '0600'
#     backup: true
#     validate: /sbin/sshd -t -f %s
#   notify: Restart sshd
